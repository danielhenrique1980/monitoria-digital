"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.isClientSide = void 0;
var _fs = _interopRequireDefault(require("fs"));
var _constants = require("../../constants");
/**
 * Check if the file is client side using the use client statement
 * @param filePath 
 * @returns 
 */
var isClientSide = function isClientSide(filePath) {
  // check if file has a valid extension
  var filePathSplit = filePath === null || filePath === void 0 ? void 0 : filePath.split('.');
  var fileExtension = filePathSplit === null || filePathSplit === void 0 ? void 0 : filePathSplit.pop();
  if (!_constants.ALLOWED_EXTENSIONS.includes(".".concat(fileExtension))) return true;
  try {
    // read the first 15 lines of the file
    var content = _fs["default"].readFileSync(filePath, {
      encoding: 'utf8'
    });
    var lines = content.split(/\r?\n/).slice(0, 15);

    // check if the file has a use client statement
    for (var i = 0; i < lines.length; i++) {
      var line = lines[i].trim();
      if (line.startsWith("'use client'") || line.startsWith('"use client"')) {
        return true;
      }
    }
    return false;
  } catch (error) {
    console.log(error);
    return false;
  }
};
exports.isClientSide = isClientSide;